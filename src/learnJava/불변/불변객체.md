# mutable, immutable

>불변 객체란, 외부에서 불변 객체의 값을 수정할 수 없는 객체

immutable 의 java 에서의 키워드 => `final`
자바에서의 `final` 은 불변을 만들어주는게 아니고, 재할당을 금지 한다.
> List, Map 등 객체 내부의 상태가 변경되지 못하게 하는것은 아니다.


### `final` 키워드의 용도별 쓰임새

1. 클래스 시그니처 -> 해당 클래스 상속 불가
2. 메소드 시그니처 -> 해당 메소드 오버라이딩 불가
3. 변수 -> 해당 변수 재할당 불가

### 불변 객체 및 final을 사용해야 하는 이유
1. Thread-safe
2. 불변 객체가 아닌, 가변 객체를 통해 작업을 진행하면 객체가 불안정한 상태에 빠질 수 있다.
3. 가비지 컬렉션의 성능을 높일 수 있다.

--- 

### 불변 클래스 만드는 방법
1. 클래스를 `final` 로 선언한다.
2. 모든 클래스 변수를 private와 final로 선언한다.
3. 객체를 생성하기 위한 생성자 또는 정적 팩토리 메소드를 추가하라.
4. 참조에 의해 변경 가능성이 있는 경우, 방어적 복사를 이용하여 전달하라
```
1. 클래스를 `final` 로 선언한다.
public final class Numbers {
    
    2. 모든 클래스 변수를 private와 final로 선언한다.
    private final List<Number> numbers;
    
    3. 객체를 생성하기 위한 생성자 또는 정적 팩토리 메소드를 추가하라.
    public Numbers(List<Number> numbers) {
        this.numbers = new ArrayList<>(numbers);
    }
    
    // 4. 참조에 의해 변경 가능성이 있는 경우, 방어적 복사를 이용하여 전달하라
    public List<Number> getNumbers() {
        return Collections.unmodifiableList(numbers);
        
        // unmodifiableList();
        // 지정된 목록의 수정할 수 없는 보기를 반환합니다.
        // 이 방법을 사용하면 모듈이 사용자에게 내부 목록에 대한 "읽기 전용" 액세스 권한을 제공할 수 있습니다.
        // 반환된 목록에 대한 쿼리 작업을 지정된 목록으로 "읽고" 직접 또는 반복자를 통해 반환된 목록을 수정하려고 하면
        // UnsupportedOperationException이 발생합니다.
        // 지정된 목록이 직렬화 가능한 경우 반환된 목록은 직렬화 가능합니다.
        // 마찬가지로 반환된 목록은 지정된 목록이 있는 경우 RandomAccess를 구현합니다.
    }

}
```
